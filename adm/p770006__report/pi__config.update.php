<?php

/*
===========================================================

	프로젝트 이름 : 피리 웹프로그램

	만든사람 : 피리 PIREE

	홈페이지 : http://www.piree.co.kr

	작성날짜 : 2014년 03월 07일 금요일 오전 10시 06분, 날씨 꽃샘추위 위세가 좀 쎄다, 쌀쌀하다

	저 작 권 : Copyright ⓒ 2014-2015 투스포츠 (원병철) All right reserved
							그누보드 외에 추가된 소스는~
							만든사람의 허락없이 무단으로 사용할수 없습니다.
							사용하고자 할 경우 만든사람의 허락을 받아야 합니다.
							http://www.piree.co.kr 에 문의해 주세요.

===========================================================
 피리 > 관리자 > 피리 신고하기 PLUS G5 > 설정 정보 수정 처리
===========================================================


*/


	#########################################################
	# 시작 => 선_처리__메뉴_지정__관리자_확인
	#########################################################

	//=======================================================
	// 메뉴_번호__지정____신고하기
	$sub_menu = "770006";


	//=======================================================
	// 기본처리_파일__첨부
	include_once('./_common.php');


	//=======================================================
	// 관리자_확인
	auth_check($auth[$sub_menu], 'r');

	#########################################################
	# 끝 => 선_처리
	#########################################################



	#########################################################
	# 시작 => 신고하기__설정_정보_파일__첨부
	#########################################################

	//=======================================================
	// 기본_설정_첨부__여부
	// 0 - 안해
	// 1 - 하자
	$is_get__piree_config = 1;


	//=======================================================
	// 신고하기__설정_정보__가져오기
	$is_get__report = 1;


	//=======================================================
	// 설정_화면__여부
	$is_piree_program_config = 1;


	//=======================================================
	// 신고하기__설정_정보_파일__경로
	$piree_dir_path = PIREE_CONFIG_PATH ."/p__".$sub_menu."/pi__config.php";


	//=======================================================
	// 신고하기__설정_정보_파일__경로
	include_once($piree_dir_path);

	#########################################################
	# 끝 => 신고하기__설정_정보_파일__첨부
	#########################################################



	#########################################################
	# 시작 => 상수__변수__배열
	#########################################################

	//=======================================================
	// 정보_저장__여부
	// 0 - 실패
	// 1 - 성공
	$is_save = $level_helper["prog_c"] != "" ? 1 : 0;


	//=======================================================
	// 이동할__페이지
	$go_url_s = "./index.php";

	#########################################################
	# 끝 => 상수__변수__배열
	#########################################################



	#########################################################
	# 시작 => 피리__기본_정보_파일__첨부
	#########################################################

	//=======================================================
	// 피리__기본_정보_파일__경로
	$piree_admin_lib_path = G5_ADMIN_PATH ."/_piree/pi__lib.php";


	//=======================================================
	// 피리__기본_정보_파일__첨부
	include_once($piree_admin_lib_path);


	//=======================================================
	// 프로그램_정보__저장하기
	save_piree__program_info();

	#########################################################
	# 끝 => 피리__기본_정보_파일__첨부
	#########################################################



	#########################################################
	# 시작 => QUERY_STRING__형변환__기본값
	#########################################################

	//=======================================================
	// QUERY_STRING
	$blind_do_t					= $_POST["blind_do_t"];
	$report_do_level_n	 = $_POST["report_do_level_n"];
	$exemption_level_n	 = $_POST["exemption_level_n"];
	$exemption_day_n		 = $_POST["exemption_day_n"];
	$report_do_point_n	 = $_POST["report_do_point_n"];
	$report_get_point_n	= $_POST["report_get_point_n"];
	$report_rash_point_n = $_POST["report_rash_point_n"];
	$report_rash_auth_n	= $_POST["report_rash_auth_n"];


	//=======================================================
	// 형변환
	$blind_do_t					= (int)$blind_do_t;
	$report_do_level_n	 = (int)$report_do_level_n;
	$exemption_level_n	 = (int)$exemption_level_n;
	$exemption_day_n		 = (int)$exemption_day_n;
	$report_do_point_n	 = (int)$report_do_point_n;
	$report_get_point_n	= (int)$report_get_point_n;
	$report_rash_point_n = (int)$report_rash_point_n;
	$report_rash_auth_n	= (int)$report_rash_auth_n;


/*

	//=======================================================
	// PC_스킨
	$skin_pc_c = $_POST['skin_pc_c'];


	//=======================================================
	// 모바일_스킨
	$skin_mobile_c = $_POST['skin_mobile_c'];


	//=======================================================
	// 블라인드__처리할__신고_건수
	$blind_do_t = $_POST["blind_do_t"];


	//=======================================================
	// 신고_가능한__레벨
	$report_do_level_n = $_POST["report_do_level_n"];


	//=======================================================
	// 신고_면제_할__레벨
	$exemption_level_n = $_POST["exemption_level_n"];


	//=======================================================
	// 신고_면제_할__가입일수
	$exemption_day_n = $_POST["exemption_day_n"];


	//=======================================================
	// 신고_한__회원의_포인트
	$report_do_point_n = $_POST["report_do_point_n"];


	//=======================================================
	// 신고_당한__회원의_포인트
	$report_get_point_n = $_POST["report_get_point_n"];


	//=======================================================
	// 무분별한__신고시_신고_한__회원의_포인트
	$report_rash_point_n = $_POST["report_rash_point_n"];


	//=======================================================
	// 무분별한_신고시__신고_권한__제한
	$report_rash_auth_n = $_POST["report_rash_auth_n"];

*/


	//=======================================================
	// 시작 => 블라인드__처리할__신고_건수
	IF (!$blind_do_t || $blind_do_t < 1)
	{
		$blind_do_t = 0;
	}
	// 끝 => 블라인드__처리할__신고_건수
	//=======================================================


	//=======================================================
	// 시작 => 신고_가능한__레벨
	IF (!$report_do_level_n || $report_do_level_n < 2)
	{
		$report_do_level_n = 1;
	}
	// 끝 => 신고_가능한__레벨
	//=======================================================


	//=======================================================
	// 시작 => 신고_면제_할__레벨
	IF (!$exemption_level_n || $exemption_level_n < 1)
	{
		$exemption_level_n = 0;
	}
	// 끝 => 신고_면제_할__레벨
	//=======================================================


	//=======================================================
	// 시작 => 신고_면제_할__가입일수
	IF (!$exemption_day_n || $exemption_day_n < 1)
	{
		$exemption_day_n = 0;
	}
	// 끝 => 신고_면제_할__가입일수
	//=======================================================


	//=======================================================
	// 시작 => 신고_한__회원의_포인트
	IF (!$report_do_point_n)
	{
		$report_do_point_n = 0;
	}
	// 끝 => 신고_한__회원의_포인트
	//=======================================================


	//=======================================================
	// 시작 => 신고_당한__회원의_포인트
	IF (!$report_get_point_n)
	{
		$report_get_point_n = 0;
	}
	// 끝 => 신고_당한__회원의_포인트
	//=======================================================


	//=======================================================
	// 시작 => 무분별한__신고시_신고_한__회원의_포인트
	IF (!$report_rash_point_n)
	{
		$report_rash_point_n = 0;
	}
	// 끝 => 무분별한__신고시_신고_한__회원의_포인트
	//=======================================================


	//=======================================================
	// 시작 => 무분별한_신고시__신고_권한__제한
	IF (!$report_rash_auth_n || $report_rash_auth_n < 1)
	{
		$report_rash_auth_n = 0;
	}
	// 끝 => 무분별한_신고시__신고_권한__제한
	//=======================================================

	#########################################################
	# 끝 => QUERY_STRING__형변환__기본값
	#########################################################



	#########################################################
	# 시작 => 신고하기_설정__저장하기
	#########################################################

		#######################################################
		# 시작 => 공통_쿼리__조합
		#######################################################

			#####################################################
			# 시작 => 공통_쿼리__스킨
			#####################################################

			//===================================================
			// 공통_쿼리__조합
			$sql_save	 = "`prog_n` = '".$g_program_n."', ";
			$sql_save .= "`prog_s` = '".$g_program_s."', ";


			//===================================================
			// 스킨
			$sql_save .= "`skin_pc_c` = '".$skin_pc_c."', ";
			$sql_save .= "skin_mobile_c = '".$skin_mobile_c."', ";

			#####################################################
			# 끝 => 공통_쿼리__스킨
			#####################################################



			#####################################################
			# 시작 => 프로그램_정보__스킨__SQL_파일_첨부
			#####################################################

			//===================================================
			// 프로그램_정보__스킨__SQL_파일_첨부
			include_once("../_piree/pi__program_info_skin_update.inc.php");

			#####################################################
			# 끝 => 프로그램_정보__스킨__SQL_파일_첨부
			#####################################################



			#####################################################
			# 시작 => 블라인드__처리할__신고_건수
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "blind_do_t";
			$config_m = addslashes("블라인드 처리할 신고 건수 >> 입력한 회수만큼 신고 받으면 ( 게시글, 댓글 )을 블라인트 처리 합니다.");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_1_c = '".$config_c."', ";
			$sql_save .= "pp_cf_1_m = '".$config_m."', ";
			$sql_save .= "pp_cf_1_n = ".$blind_do_t.", ";
			$sql_save .= "pp_cf_1_s = '', ";

			#####################################################
			# 끝 => 블라인드__처리할__신고_건수
			#####################################################



			#####################################################
			# 시작 => 신고_가능한__레벨
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "report_do_level_n";
			$config_m = addslashes("신고 가능한 레벨 >> 입력하신 레벨 이상 회원은 \"신고하기\" 할수 있습니다.");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_2_c = '".$config_c."', ";
			$sql_save .= "pp_cf_2_m = '".$config_m."', ";
			$sql_save .= "pp_cf_2_n = ".$report_do_level_n.", ";
			$sql_save .= "pp_cf_2_s = '', ";

			#####################################################
			# 끝 => 신고_가능한__레벨
			#####################################################



			#####################################################
			# 시작 => 신고_면제_할__레벨
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "exemption_level_n";
			$config_m = addslashes("신고 면제 할 레벨 >> 입력하신 레벨 이상인 회원을 대상으로 \"신고하기\" 할수 없습니다. ( 신고 대상 면제하는 특권 )");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_3_c = '".$config_c."', ";
			$sql_save .= "pp_cf_3_m = '".$config_m."', ";
			$sql_save .= "pp_cf_3_n = ".$exemption_level_n.", ";
			$sql_save .= "pp_cf_3_s = '', ";

			#####################################################
			# 끝 => 신고_면제_할__레벨
			#####################################################



			#####################################################
			# 시작 => 신고_면제_할__가입일수
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "exemption_day_n";
			$config_m = addslashes("신고 면제 할 가입일수 >> \"가입후 입력한 날짜수\" 만큼 지난 회원을 대상으로 \"신고하기\" 할수 없습니다. ( 신고 대상 면제하는 특권 )");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_4_c = '".$config_c."', ";
			$sql_save .= "pp_cf_4_m = '".$config_m."', ";
			$sql_save .= "pp_cf_4_n = ".$exemption_day_n.", ";
			$sql_save .= "pp_cf_4_s = '', ";

			#####################################################
			# 끝 => 신고_면제_할__가입일수
			#####################################################



			#####################################################
			# 시작 => 신고_한__회원의_포인트
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "report_do_point_n";
			$config_m = addslashes("신고 한 회원의 포인트 >> 신고할때 신고한 회원의 포인트 ( 지급, 차감을 선택할수 있음 ), 입력 않하시면 포인트 변동 없음");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_5_c = '".$config_c."', ";
			$sql_save .= "pp_cf_5_m = '".$config_m."', ";
			$sql_save .= "pp_cf_5_n = ".$report_do_point_n.", ";
			$sql_save .= "pp_cf_5_s = '', ";

			#####################################################
			# 끝 => 신고_한__회원의_포인트
			#####################################################



			#####################################################
			# 시작 => 신고_당한__회원의_포인트
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "report_get_point_n";
			$config_m = addslashes("신고 당한(받은) 회원의 포인트 >> 신고 당한(받은) 회원의 포인트 ( 지급, 차감을 선택할수 있음 ), 입력 않하시면 포인트 변동 없음");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_6_c = '".$config_c."', ";
			$sql_save .= "pp_cf_6_m = '".$config_m."', ";
			$sql_save .= "pp_cf_6_n = ".$report_get_point_n.", ";
			$sql_save .= "pp_cf_6_s = '', ";

			#####################################################
			# 끝 => 신고_당한__회원의_포인트
			#####################################################



			#####################################################
			# 시작 => 무분별한__신고시_신고_한__회원의_포인트
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "report_rash_point_n";
			$config_m = addslashes("무분별한 신고시 신고 한 회원의 포인트 >> 무분별한 신고시 신고한 회원의 포인트 ( 지급, 차감을 선택할수 있음 ), 입력 않하시면 포인트 변동 없음");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_7_c = '".$config_c."', ";
			$sql_save .= "pp_cf_7_m = '".$config_m."', ";
			$sql_save .= "pp_cf_7_n = ".$report_rash_point_n.", ";
			$sql_save .= "pp_cf_7_s = '', ";

			#####################################################
			# 끝 => 무분별한__신고시_신고_한__회원의_포인트
			#####################################################



			#####################################################
			# 시작 => 무분별한_신고시__신고_권한__제한
			#####################################################

			//===================================================
			// 코드_메모
			$config_c = "report_rash_auth_n";
			$config_m = addslashes("무분별한 신고시 신고 권한 제한 >> 입력한 회수만큼 무분별한 신고를 하면 신고할수 있는 권한을 제한함");


			//===================================================
			// 공통_쿼리
			$sql_save .= "pp_cf_8_c = '".$config_c."', ";
			$sql_save .= "pp_cf_8_m = '".$config_m."', ";
			$sql_save .= "pp_cf_8_n = ".$report_rash_auth_n.", ";
			$sql_save .= "pp_cf_8_s = '', ";

			#####################################################
			# 끝 => 무분별한_신고시__신고_권한__제한
			#####################################################

		#######################################################
		# 끝 => 공통_쿼리__조합
		#######################################################



		#######################################################
		# 시작 => 설정__저장하기
		#######################################################

		//=====================================================
		// 수정하는__쿼리
		$sql	= "UPDATE `".$piree_table['program']."` SET ";
		$sql .= $sql_save;
		$sql .= "modi_time_n='".G5_SERVER_TIME."' ";
		$sql .= "WHERE `prog_n` = ".$g_program_n;


		//=====================================================
		// 시작 => 쿼리_실행
		IF ( !sql_query ($sql) )
		{

			// 에러_메세지
			$save_err_msg = "신고하기 설정 정보를 수정하지 못했습니다.";

			// 에러
			alert ($save_err_msg, $go_url_s);
			EXIT;

		}
		// 끝 => 쿼리_실행
		//=====================================================

		#######################################################
		# 끝 => 설정__저장하기
		#######################################################

	#########################################################
	# 끝 => 신고하기_설정__저장하기
	#########################################################



	#########################################################
	# 시작 => 마무리__페이지_이동
	#########################################################

	//=======================================================
	// 이동할__페이지
	$go_url_s = "./pi__field_add.article.php";


	//=======================================================
	// 페이지_이동
	goto_url($go_url_s);
	EXIT;

	#########################################################
	# 끝 => 마무리__페이지_이동
	#########################################################


?>